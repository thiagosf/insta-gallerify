(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){e.exports=a(47)},21:function(e,t,a){},24:function(e,t,a){},25:function(e,t,a){},41:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(8),s=a.n(i),o=(a(21),a(22),a(23),a(10)),l=a(1),c=a(2),u=a(4),m=a(3),f=a(5),h=(a(24),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",valid:!1,fullscreen:!1},a._getClasses=function(){var e=["main-header"];return a.props.loading&&e.push("main-header--loading"),e.join(" ")},a._handleKey=function(e){"Enter"===e.key&&a._setValid()},a._handleBlur=function(){a.state.username&&a._setValid()},a._handleChange=function(e){a.setState({username:e.target.value.trim()})},a._setValid=function(){var e=""!==a.state.username;a.setState({valid:e},function(){a.props.onSetUsername(a.state.username)})},a._edit=function(){a.setState({valid:!1},function(){a.input.select()})},a._toggleFullScreen=function(){a.setState({fullscreen:!a.state.fullscreen},function(){a.state.fullscreen?document.body.requestFullscreen():document.exitFullscreen()})},a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,a=this.props.username;a!==e.username&&this.setState({username:a},function(){t._setValid()})}},{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.valid;return r.a.createElement("header",{className:this._getClasses()},r.a.createElement("span",{className:"main-header__fullscreen",onClick:this._toggleFullScreen},r.a.createElement("span",{role:"img","aria-label":"eyeglasses"},"\ud83d\udc53")),n&&r.a.createElement("div",{className:"main-header__user",onClick:this._edit},r.a.createElement("p",{className:"main-header__user__name"},a)),!n&&r.a.createElement("input",{autoFocus:!0,name:"username",className:"main-header__input",ref:function(t){return e.input=t},type:"text",value:a,placeholder:"@username",onChange:this._handleChange,onKeyPress:this._handleKey,onBlur:this._handleBlur}))}}]),t}(n.Component));h.defaultProps={loading:!1,username:null,onSetUsername:function(){}};var p=h,_=(a(25),function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",{className:"main-footer"},r.a.createElement("a",{className:"main-footer__link",href:"https://github.com/thiagosf/insta-gallerify"},"github"))}}]),t}(n.Component)),g=a(13),d=a.n(g),v=a(14),b=a.n(v),y=(a(41),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r))))._friendlyLikes=function(){var e=a.props.likes;return e>1e3?b()(e).format("0.0a"):e},a._getLink=function(){var e=a.props.shortcode;return"https://www.instagram.com/p/".concat(e)},a._getDate=function(){var e=a.props.timestamp;return new Date(1e3*+e).toLocaleString()},a._getFavoriteClasses=function(){var e=["photo__info__favorite"];return a.props.favorite&&e.push("photo__info__favorite--active"),e.join(" ")},a._toggleFavorite=function(){a.props.onFavorite({url:a.props.url,shortcode:a.props.shortcode,timestamp:a.props.timestamp,likes:a.props.likes})},a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.url;return r.a.createElement("div",{className:"photo"},r.a.createElement("div",{className:"photo__info"},r.a.createElement("div",{className:"photo__info__vertical-group"},r.a.createElement("span",{className:this._getFavoriteClasses(),onClick:this._toggleFavorite},r.a.createElement("span",{className:"photo__info__favorite__icon",role:"img","aria-label":"star"},"\u2b50\ufe0f")),r.a.createElement("span",{className:"photo__info__likes"},r.a.createElement("span",{className:"photo__info__likes__icon",role:"img","aria-label":"heart"},"\u2764\ufe0f")," ",this._friendlyLikes())),r.a.createElement("span",{className:"photo__info__timestamp"},this._getDate()),r.a.createElement("a",{href:this._getLink(),target:"_blank",rel:"noopener noreferrer",className:"photo__info__link"},"link")),r.a.createElement("img",{src:e,alt:""}))}}]),t}(n.Component));y.defaultProps={url:"",shortcode:"",timestamp:"",likes:0,favorite:!1,onFavorite:function(){}};var w=y,k={fetchUser:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,a="https://www.instagram.com/".concat(e,"/?__a=1");return fetch(a).then(function(e){if(!1===e.ok)throw new Error("We didn't get API response. Please, try again.");return e.json()}).then(function(e){if(e.graphql.user.is_private)throw new Error("User profile is private.");var a=[],n=[];if(e.graphql){var r=e.graphql.user.id,i=e.graphql.user.edge_owner_to_timeline_media,s=i.edges,o=i.count,l=e.graphql.user.edge_owner_to_timeline_media.page_info.has_next_page,c=e.graphql.user.edge_owner_to_timeline_media.page_info.end_cursor,u=e.graphql.user.is_private;if(o>0&&!u&&(n=s.map(function(e){return{url:e.node.display_url,shortcode:e.node.shortcode,timestamp:e.node.taken_at_timestamp,likes:+e.node.edge_liked_by.count}})),l){var m=1;a.push(function e(a){var i={query_hash:"f2405b236d85e8296cf30347c9f08c2a",variables:'{"id":"'.concat(r,'","first":').concat(50,',"after":"').concat(a,'"}')},s="https://www.instagram.com/graphql/query?query_hash=".concat(i.query_hash,"&variables=").concat(i.variables);return fetch(s).then(function(e){return e.json()}).then(function(a){if("ok"===a.status){var r=a.data.user.edge_owner_to_timeline_media.edges,i=a.data.user.edge_owner_to_timeline_media.page_info.has_next_page,s=a.data.user.edge_owner_to_timeline_media.page_info.end_cursor;if(r.forEach(function(e){n.push({url:e.node.display_url,thumbnail_url:e.node.thumbnail_src,shortcode:e.node.shortcode,timestamp:e.node.taken_at_timestamp,likes:+e.node.edge_media_preview_like.count})}),m++,i&&m<20&&(n.length<+t||0===+t))return e(s)}}).catch(function(e){console.log("pagination error:",e)})}(c))}}if(0===n.length)throw new Error("User not found.");return Promise.all(a).then(function(){return n})}).catch(function(e){throw new Error(e)})}},O=a(15),j=a.n(O),E={filterImages:function(e){var t=e.images,a=e.sort,n=e.limit,r=[].concat(t);return"likes"===a?r=j.a.sortBy(r,"likes").reverse():"oldest"===a&&(r=r.reverse()),n>0&&(r=r.slice(0,n)),r},toggleFavorite:function(e){var t=this.getFavorites();t.find(function(t){return t.url===e.url})?t=t.filter(function(t){return t.url!==e.url}):t.push(e),t=JSON.stringify(t),localStorage.setItem("favorites",t)},isFavorite:function(e){return void 0!==this.getFavorites().find(function(t){return t.url===e.url})},getFavorites:function(){var e=localStorage.getItem("favorites");return e=e?JSON.parse(e):[]}},S=(a(43),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i))))._onFavorite=function(e){E.toggleFavorite(e),a.props.onFavorite(e)},a._getThumbView=function(){return r.a.createElement("div",{className:"gallery-thumb-view"},a.props.images.map(function(e,t){return r.a.createElement("div",{key:t,className:"gallery-thumb-view__item"},r.a.createElement("img",{className:"gallery-thumb-view__item__image",src:e.thumbnail_url,alt:e.shortcode,onClick:function(){a.props.onSelectImage(t)}}))}))},a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.images.length===e.images.length&&this.props.filters===e.filters||this.slider&&this.slider.slickGoTo(0)}},{key:"render",value:function(){var e=this,t=this.props,a=t.images,n=t.thumbView;if(0===a.length)return!1;if(n)return this._getThumbView();var i=a.map(function(t,a){return r.a.createElement(w,{key:a,url:t.url,shortcode:t.shortcode,timestamp:t.timestamp,favorite:t.favorite,likes:t.likes,onFavorite:e._onFavorite})});return r.a.createElement(d.a,Object.assign({ref:function(t){return e.slider=t}},{dots:!1,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,variableWidth:!1,accessibility:!0,lazyLoad:"ondemand"}),i)}},{key:"goTo",value:function(e){this.slider.slickGoTo(e,!0)}}]),t}(n.Component));S.defaultProps={filters:{},images:[],onFavorite:function(){},onSelectImage:function(){},thumbView:!1};var F=S,C=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i))))._getItems=function(){var e=a.props,t=e.values,n=e.selected;return t.map(function(e,t){var i=["gallery-filters__filter__value"];return e.value===n&&i.push("gallery-filters__filter__value--active"),r.a.createElement("span",{key:t,className:i.join(" "),onClick:function(){return a.props.onChange(e.value)}},e.label)})},a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"gallery-filters__filter"},this._getItems())}}]),t}(n.Component);C.defaultProps={onChange:function(){},selected:null,values:[]};var N=C,U=(a(44),function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i))))._getClasses=function(){var e=["gallery-filters"];return a.props.loading&&e.push("gallery-filters--loading"),e.join(" ")},a._getSortFilters=function(){var e=a.props.filters.sort,t=void 0===e?"recent":e;return r.a.createElement(N,{selected:t,values:[{value:"likes",label:"likes"},{value:"recent",label:"recent"},{value:"oldest",label:"oldest"}],onChange:function(e){return a._onChangeFilter("sort",e)}})},a._getLimitFilters=function(){var e=a.props.filters.limit,t=void 0===e?50:e;return r.a.createElement(N,{selected:t,values:[{value:10,label:10},{value:50,label:50},{value:0,label:"all"}],onChange:function(e){return a._onChangeFilter("limit",e)}})},a._getModeFilters=function(){var e=a.props.filters.mode,t=void 0===e?"gallery":e;return r.a.createElement(N,{selected:t,values:[{value:"gallery",label:"gallery"},{value:"thumb",label:"thumb"}],onChange:function(e){return a._onChangeFilter("mode",e)}})},a._onChangeFilter=function(e,t){a.props.onChange(e,t)},a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:this._getClasses()},this._getSortFilters(),this._getLimitFilters(),this._getModeFilters())}}]),t}(n.Component));U.defaultProps={loading:!1,onChange:function(){},filters:{}};var I=U,L=(a(45),function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"spinner"},r.a.createElement("span",{className:"spinner__circle"}))}}]),t}(n.Component));a(46);function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(a,!0).forEach(function(t){Object(o.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var D=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={username:null,images:[],filters:{},favorites:[],showThumbs:!1,loading:!1,error:null,lastLimit:50,exampleUsers:["angrymikko","jaromvogel","zatransis","rebeccamillsdraws","\u2b50\ufe0f"]},a._onSetUsername=function(e){if(e)if("\u2b50\ufe0f"===e||"favorites"===e){window.history.pushState({},"username_favorites","#/@favorites"),document.title="favorites / Insta Gallerify";var t=E.getFavorites();t.length>0?a.setState({username:e,images:t}):a.setState({error:"You have no favorites yet!",username:"",images:[]})}else{window.history.pushState({},"username_".concat(e),"#/@".concat(e)),document.title="@".concat(e," / Insta Gallerify");var n=a.state.filters.limit||a.state.lastLimit||50;e!==a.state.username&&a.setState({loading:!0,lastLimit:n},function(){return a._loadData(e,a.state.filters.limit)})}else a.setState({username:"",images:[]})},a._loadData=function(e,t){return k.fetchUser(e,t).then(function(t){a.setState({username:e,images:t})}).catch(function(e){a.setState({error:e.message,username:"",images:[]})}).finally(function(){a.setState({loading:!1})})},a._galleryImages=function(){var e=[],t=a.state,n=t.images,r=t.filters;return n.length>0&&(e=E.filterImages(q({images:n},r))),e=e.map(function(e){return q({},e,{favorite:E.isFavorite(e)})})},a._onFilter=function(e,t){var n=q({},a.state.filters,Object(o.a)({},e,t));a.setState({filters:n},function(){if(a.state.lastLimit>0&&(a.state.lastLimit<n.limit||0!==a.state.lastLimit&&0===n.limit)){var e=n.limit;a.setState({loading:!0,lastLimit:e},function(){a._loadData(a.state.username,e)})}})},a._getExampleUsers=function(){return a.state.exampleUsers.map(function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("span",{onClick:function(){return a._onSetUsername(e)}},e))})},a._checkUsernameInHash=function(e){var t=e.split("@");t.length>0&&a._onSetUsername(t[1])},a._onHashChange=function(e){a._checkUsernameInHash(e.newURL)},a._onFavorite=function(e){var t=a.state.images.map(function(t){return t.url===e.url&&(t.favorite=!t.favorite),t});a.setState({images:t})},a._onSelectImage=function(e){var t=q({},a.state.filters,{mode:"gallery"});a.setState({filters:t},function(){a.gallery.goTo(e)})},a}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){window.location.hash&&this._checkUsernameInHash(window.location.hash),window.addEventListener("hashchange",this._onHashChange)}},{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.images,i=t.loading,s=t.error;return r.a.createElement("div",{className:"app"},r.a.createElement(p,{loading:i,username:a,onSetUsername:this._onSetUsername}),r.a.createElement(I,{loading:i,filters:this.state.filters,onChange:this._onFilter}),!i&&r.a.createElement(F,{ref:function(t){return e.gallery=t},filters:this.state.filters,images:this._galleryImages(),onFavorite:this._onFavorite,thumbView:"thumb"===this.state.filters.mode,onSelectImage:this._onSelectImage}),i&&r.a.createElement(L,null),0===n.length&&!i&&r.a.createElement("div",{className:"app__start"},s&&r.a.createElement("p",{className:"app__start__error"},s),r.a.createElement("p",{className:"app__start__message"},"Fill the username ",r.a.createElement("span",{role:"img","aria-label":"point_up"},"\u261d\ufe0f")),r.a.createElement("p",{className:"app__start__example"},"Examples:"),r.a.createElement("ul",{className:"app__start__example-users"},this._getExampleUsers())),r.a.createElement(_,null))}}]),t}(n.Component);s.a.render(r.a.createElement(D,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.edfe405b.chunk.js.map